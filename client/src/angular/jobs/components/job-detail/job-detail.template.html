<div ng-if="!$ctrl.job">
    <div class="alert-detail">
        <i class="fa fa-spinner fa-spin"></i> Loading...
    </div>
</div>
<div ng-if="$ctrl.job">
    <h2>{{ $ctrl.job.name }}</h2>
    <div class="job-name-subtext">
        <b>Job ID: </b>{{ $ctrl.job.id }} |
        <b>Application: </b>{{ $ctrl.job.appId }} |
        <b>System: </b>{{ $ctrl.job.systemId }}
    </div>
    <div class="job-summary-left">
        <dl>
            <dt>Output</dt>
            <dd ng-if="!$ctrl.jobFinished"><i>Output pending</i></dd>
            <dd><a href="{{ $ctrl.job.archiveUrl }}">View in Data Depot</a></dd>
            <dd><a href="{{ $ctrl.job.jupyterUrl }}" ng-if="$ctrl.job.jupyterUrl" target=_blank>View in JupyterHub</a></dd>
        </dl>
        <job-actions job="$ctrl.job"></job-actions>
    </div>
    <div class="job-summary-right">
        <div class="job-summary-panel">
            <b>Status</b>
            <div class="job-status-event">
                <div>Submitted</div>
                <div>{{ $ctrl.convertDate($ctrl.job.created) }}</div>
            </div>
            <div class="job-status-event">
                <div>
                    <span ng-class="$ctrl.Jobs.getStatusClass($ctrl.job)">
                        <b>&nbsp;{{ $ctrl.job.status }}&nbsp;</b>
                    </span>
                </div>
                <div>{{ $ctrl.convertDate($ctrl.job.ended) }}</div>
            </div>
        </div>
        <div class="job-status-dropdown">
            <div ng-class="$ctrl.Jobs.getStatusClass($ctrl.job)">
                <span class="job-status-padding" ng-click="$ctrl.statusToggle()">
                    Status Report&nbsp;
                    <i ng-if="!$ctrl.expandStatus" class="fa fa-chevron-circle-down"></i>
                    <i ng-if="$ctrl.expandStatus" class="fa fa-chevron-circle-up"></i>
                </span>
            </div>
            <div ng-if="$ctrl.expandStatus" class="job-status-padding status-message">
                <p>{{$ctrl.job.lastStatusMessage}}</p>
            </div>
        </div>
        <div ng-if="!$ctrl.summary" class="job-detail agave-info">
            <table class="agave-job">
                <tr>
                    <th width="20%">Inputs</th>
                </tr>
                <tr ng-repeat="(input, value) in $ctrl.job.inputs">
                    <td class="array-item">
                        {{ input }}
                    </td>
                    <td ng-bind-html="$ctrl.renderInput(value)">
                    </td>
                </tr>
                <tr>
                    <th>Parameters</th>
                </tr>
                <tr ng-repeat="(parameter, value) in $ctrl.job.parameters">
                    <td class="array-item">{{ parameter }}</td>
                    <td>{{ value }}</td>
                </tr>
                <tr>
                    <th>Max Hours</th>
                    <td>{{ $ctrl.job.maxHours }}</td>
                </tr>
                <tr>
                    <th>Archive Path</th>
                    <td><a href="{{ $ctrl.job.archiveUrl }}">agave://{{ $ctrl.job.archiveSystem }}/{{ $ctrl.job.archivePath }}</a></td>
                </tr>
                <tr>
                    <th>Node Count</th>
                    <td>{{ $ctrl.job.nodeCount }}</td>
                </tr>
                <tr>
                    <th>Processors per Node</th>
                    <td>{{ $ctrl.job.processorsPerNode }}</td>
                </tr>
                <tr>
                    <th>Memory Per Node</th>
                    <td>{{ $ctrl.job.memoryPerNode }}</td>
                </tr>
                <tr>
                    <th>Remote Queue</th>
                    <td>{{ $ctrl.job.remoteQueue }}</td>
                </tr>
                <tr>
                    <th>Work Path</th>
                    <td>{{ $ctrl.job.workPath }}</td>
                </tr>
            </table>
        </div>
    </div>
</div>
